---
title: Authentication
description: Implementing authentication in Glueful applications
navigation:
  icon: i-lucide-lock
---

# Authentication

This section covers authentication in the Glueful framework.

## JWT Authentication

Glueful uses JSON Web Tokens (JWT) for secure, stateless authentication:

```php
<?php

// Login endpoint implementation
public function login(Request $request)
{
    $validator = new Validator();
    $validator->validate($request->request->all(), [
        'email' => 'required|email',
        'password' => 'required|string',
    ]);

    if ($validator->fails()) {
        return Response::badRequest(['errors' => $validator->errors()]);
    }

    $email = $request->request->get('email');
    $password = $request->request->get('password');

    $user = $this->userRepository->findByEmail($email);

    if (!$user || !password_verify($password, $user['password'])) {
        return Response::unauthorized(['message' => 'Invalid credentials']);
    }

    // Generate tokens
    $accessToken = $this->authService->generateAccessToken($user);
    $refreshToken = $this->authService->generateRefreshToken($user);

    return Response::ok([
        'access_token' => $accessToken,
        'refresh_token' => $refreshToken,
        'token_type' => 'Bearer',
        'expires_in' => (int)env('ACCESS_TOKEN_LIFETIME', 900)
    ]);
}
```

## Protected Routes

Secure routes with authentication middleware:

```php
// Route with authentication
Router::get('/profile', [ProfileController::class, 'show'], requiresAuth: true);

// Admin-only route
Router::get('/admin/dashboard', [AdminController::class, 'dashboard'], requiresAuth: true, requiresAdminAuth: true);

// Using middleware directly
Router::get('/settings', [SettingsController::class, 'index'])
    ->middleware(AuthenticationMiddleware::class);
```

## Role-Based Access Control

Glueful includes a comprehensive RBAC system:

```php
// Check user roles and permissions
if (!$this->authService->hasPermission($user, 'manage_users')) {
    return Response::forbidden(['message' => 'Insufficient permissions']);
}

// Assign roles to users
$this->roleRepository->assignRoleToUser($user['uuid'], 'admin');

// Create new roles and permissions
$roleId = $this->roleRepository->createRole([
    'name' => 'editor',
    'description' => 'Content editor role'
]);
$this->permissionRepository->addPermissionToRole($roleId, 'edit_content');
```
