---
title: Extension System Overview
description: Understanding the Glueful extension architecture
navigation:
  icon: i-lucide-puzzle
---

This section provides an overview of the Glueful extension system architecture.

## Architecture

The Glueful extension system is designed to provide modular functionality that can be easily added, removed, or customized without modifying the core codebase. Extensions in Glueful follow a standardized architecture that promotes:

- **Modularity**: Each extension is self-contained with its own functionality
- **Discoverability**: Extensions are automatically discovered and loaded by the ExtensionsManager
- **Standardization**: All extensions follow the same interface and lifecycle methods
- **Configuration**: Extensions can be easily enabled/disabled and configured

At its core, every Glueful extension extends the base `Extensions` class and implements the `IExtensions` interface. This provides a consistent way to initialize, register, and process extension functionality.

## Directory Structure

Extensions follow a standardized directory structure within the Glueful application:

```
glueful/
├── extensions/                 # Main extensions directory
│   ├── ExtensionName/          # Individual extension directory (PascalCase)
│   │   ├── ExtensionName.php   # Main extension class (same name as folder)
│   │   ├── config.php          # Extension configuration
│   │   ├── routes.php          # Extension routes
│   │   ├── README.md           # Documentation
│   │   ├── migrations/         # Database migrations (if needed)
│   │   ├── Providers/          # Service providers
│   │   └── ...                 # Other extension files
│   └── ...
└── config/
    └── extensions.php          # Extension configuration
```

All extensions are stored in the `/extensions` directory, with each extension having its own subdirectory. The main extension class must have the same name as its directory and be located at the root of that directory.

## Extension Lifecycle

Extensions in Glueful go through a defined lifecycle that is managed by the ExtensionsManager:

1. **Discovery**: The ExtensionsManager scans the extensions directory and config file to find available extensions
2. **Loading**: Enabled extensions are loaded and their namespaces are registered with the autoloader
3. **Initialization**: Each extension's `initialize()` method is called to set up required resources
4. **Service Registration**: Extensions register their services via the `registerServices()` method
5. **Middleware Registration**: Extensions register their middleware via `registerMiddleware()` method
6. **Request Processing**: When extension functionality is requested, the `process()` method handles it

### Key Lifecycle Methods

All extensions must implement these core methods:

```php
// Required by IExtensions interface
public static function process(array $getParams, array $postParams): array;

// Common extension lifecycle methods
public static function initialize(): void;
public static function registerServices(): void;
public static function registerMiddleware(): void;
public static function getMetadata(): array;
```

### Additional Extension Methods

Beyond the core lifecycle methods, Glueful extensions can implement several additional methods to provide enhanced functionality:

```php
// Dependency management
public static function getDependencies(): array;

// Environment-specific behavior
public static function isEnabledForEnvironment(string $environment): bool;

// Health and diagnostics
public static function checkHealth(): array;

// Resource monitoring
public static function getResourceUsage(): array;

// UI elements for admin dashboard
public static function getScreenshots(): array;

// Version history information
public static function getChangelog(): array;
```

#### Middleware Integration

The `registerMiddleware()` method allows extensions to hook into the application's HTTP middleware pipeline. Extensions can register custom middleware components that process HTTP requests and responses:

```php
public static function registerMiddleware(): void
{
    // Register middleware with the application's pipeline
    $app = \Glueful\App::getInstance();
    $app->middleware()->add(YourMiddlewareClass::class);
}
```

#### Environment-Specific Configuration

Extensions can control whether they should be enabled in specific environments (development, staging, production) using the `isEnabledForEnvironment()` method:

```php
public static function isEnabledForEnvironment(string $environment): bool
{
    // Only enable in production and staging environments
    return in_array($environment, ['production', 'staging']);
    
    // Or for development-only extensions:
    // return $environment === 'development';
}
```

#### Health Checks

The `checkHealth()` method provides diagnostic information about the extension's status:

```php
public static function checkHealth(): array
{
    $issues = [];
    
    // Perform health checks
    if (!extension_loaded('required_php_extension')) {
        $issues[] = 'Missing required PHP extension';
    }
    
    return [
        'healthy' => empty($issues),
        'issues' => $issues,
        'metrics' => [
            'memory_usage' => 1024 * 50, // 50KB
            'execution_time' => 15, // 15ms
            'database_queries' => 2,
            'cache_usage' => 1024 * 10 // 10KB
        ]
    ];
}
```

#### Resource Usage Monitoring

Extensions can report their resource consumption through the `getResourceUsage()` method:

```php
public static function getResourceUsage(): array
{
    return [
        'memory_usage' => 1024 * 250, // bytes
        'execution_time' => 25, // milliseconds
        'database_queries' => 5, // count
        'cache_usage' => 1024 * 30 // bytes
    ];
}
```

#### Extension Gallery Content

The `getScreenshots()` method returns information about screenshots for display in the admin UI:

```php
public static function getScreenshots(): array
{
    return [
        [
            'title' => 'Dashboard View',
            'description' => 'Main dashboard interface',
            'url' => 'screenshots/dashboard.png',
            'thumbnail' => 'screenshots/thumb.dashboard.png'
        ]
    ];
}
```

#### Version History

Extensions can provide their changelog information through the `getChangelog()` method:

```php
public static function getChangelog(): array
{
    return [
        [
            'version' => '1.1.0',
            'date' => '2025-04-15',
            'changes' => [
                'Added new authentication provider',
                'Fixed issue with token expiration',
                'Improved error handling'
            ]
        ],
        [
            'version' => '1.0.0',
            'date' => '2025-02-01',
            'changes' => [
                'Initial release'
            ]
        ]
    ];
}
```

## Creating Extensions

To create a new extension for Glueful, follow these steps:

1. Create a new directory in the `extensions/` folder with a PascalCase name
2. Create a main extension class that extends `Glueful\Extensions`
3. Implement the required lifecycle methods
4. Create configuration and route files as needed
5. Enable the extension in `config/extensions.php`

Example of a basic extension:

```php
<?php
declare(strict_types=1);

namespace Glueful\Extensions\YourExtension;

use Glueful\Extensions;

class YourExtension extends Extensions
{
    public static function initialize(): void
    {
        // Set up your extension
    }
    
    public static function registerServices(): void
    {
        // Register services
    }
    
    public static function process(array $getParams, array $postParams): array
    {
        // Handle extension requests
        return ['status' => 'success'];
    }
    
    public static function getMetadata(): array
    {
        return [
            'name' => 'YourExtension',
            'description' => 'Description of your extension',
            'version' => '1.0.0',
            'author' => 'Your Name',
            'requires' => [
                'glueful' => '>=1.0.0',
                'php' => '>=8.1.0',
                'extensions' => [] // List of required extensions
            ]
        ];
    }
}
```

## Configuration

Extensions are configured in the `config/extensions.php` file:

```php
<?php
return [
    'enabled' => [
        'ExtensionName',
        'AnotherExtension'
    ],
    'paths' => [
        'extensions' => '/path/to/extensions'
    ]
];
```

Individual extensions can also have their own configuration files, typically located at `extensions/ExtensionName/config.php`.

## Extension Metadata

Extensions should provide metadata through the `getMetadata()` method. This information is used for dependency tracking, displaying extension information in the admin UI, and ensuring compatibility.

Required metadata fields include:
- `name`: Display name of the extension
- `description`: Brief description of what the extension does
- `version`: Semantic version (e.g., "1.0.0")
- `author`: Author name or organization
- `requires`: Object containing dependency requirements

Example metadata:

```php
public static function getMetadata(): array
{
    return [
        'name' => 'SocialLogin',
        'description' => 'Adds social authentication capabilities',
        'version' => '1.2.0',
        'author' => 'Glueful Team',
        'requires' => [
            'glueful' => '>=1.0.0',
            'php' => '>=8.1.0',
            'extensions' => ['UserManagement']
        ]
    ];
}
```

## Extension Management

Extensions can be managed through the Glueful CLI or through the admin dashboard UI.

### CLI Commands

```bash
# List all extensions
php glueful extensions list

# Get extension details
php glueful extensions info ExtensionName

# Enable an extension
php glueful extensions enable ExtensionName

# Disable an extension
php glueful extensions disable ExtensionName
```

### Admin Dashboard

The admin dashboard provides a visual interface for managing extensions. You can:

- View all available extensions
- See which extensions are enabled/disabled
- Enable or disable extensions
- View extension metadata and health information

## Best Practices

When developing extensions for Glueful, follow these best practices:

1. **Keep extensions self-contained**: Each extension should be independent and not rely on other extensions unless explicitly declared as a dependency
2. **Use proper namespacing**: All classes should be in the `Glueful\Extensions\YourExtension\` namespace
3. **Document your extension**: Include a README.md file with documentation on how to use your extension
4. **Follow coding standards**: Follow the same coding standards as the rest of the Glueful framework
5. **Include tests**: Write tests for your extension functionality
6. **Use dependency injection**: When possible, use dependency injection to make your code more testable and maintainable
