---
title: Extension Configuration
description: Configuring extensions in the Glueful framework
navigation:
  icon: i-lucide-settings-2
---

This section covers how to configure extensions in the Glueful framework. Proper configuration allows you to customize extension behavior without modifying the extension code, promoting better maintainability and adaptability to different environments.

## Configuration Files

Glueful offers multiple ways to configure extensions, with configuration files being the primary method.

### Main Extensions Configuration

Extensions are enabled and configured globally in the `config/extensions.php` file. With the tiered extension system, this configuration now includes explicit categorization of extensions:

```php
<?php
return [
  'core' => [
    'EmailNotification',
    // Core extensions that are essential for system operation
  ],
  'optional' => [
    'SocialLogin',
    'Admin',
    // Optional extensions that add additional functionality
  ],
  'enabled' => [
    'EmailNotification',
    'SocialLogin',
    // All extensions that are currently active
  ],
  'paths' => [
    'extensions' => '/path/to/extensions/',
  ],
];
```

This file specifies:
- **core**: An array of extension names that are considered essential for the system
- **optional**: An array of extension names that provide additional but non-essential functionality
- **enabled**: An array of all extension names that should be loaded and initialized
- **paths**: Directory paths where the framework should look for extensions

The categorization of extensions as core or optional affects how they're managed in the system, particularly regarding:
- Startup behavior (core extensions may auto-load in production)
- Disabling safeguards (core extensions require confirmation)
- Dependency resolution (core extensions may be prioritized)

### Extension-specific Configuration

Each extension can have its own configuration file, typically named `config.php` within the extension's directory:

```php
<?php
/**
 * Extension Configuration
 */
return [
    'option1' => 'value1',
    'option2' => 'value2',
    // Extension-specific configuration options
];
```

#### Tier-Specific Configuration Considerations

Core and optional extensions often have different configuration requirements:

**Core Extensions**:
```php
<?php
/**
 * Core Extension Configuration
 */
return [
    // Required settings that should not be modified in production
    'critical_setting' => 'default_value', // Critical setting with production-safe default
    
    // Performance tuning parameters
    'performance' => [
        'cache_lifetime' => 3600,
        'prefetch_enabled' => true,
    ],
    
    // Security settings
    'security' => [
        'log_sensitive_operations' => true,
        'enforce_strong_validation' => true,
    ],
    
    // Override protection to prevent accidental changes to critical options
    '_protected_settings' => [
        'critical_setting',
        'security.enforce_strong_validation'
    ]
];
```

**Optional Extensions**:
```php
<?php
/**
 * Optional Extension Configuration
 */
return [
    // More customizable settings
    'feature_flags' => [
        'enable_experimental' => false,
        'beta_features' => false,
    ],
    
    // Integration settings that can be freely modified
    'integration' => [
        'api_endpoint' => 'https://example.com/api',
        'timeout' => 30,
    ],
    
    // User preferences
    'display' => [
        'show_in_menu' => true,
        'icon' => 'default',
    ]
];
```

### Accessing Configuration in Extensions

Extensions can access their configuration using the static `getConfig()` method:

```php
// Inside your extension class
$config = \Glueful\Extensions\YourExtension::getConfig();

// Access configuration values
$option1 = $config['option1'] ?? 'default_value';
```

## Environment Variables

Glueful's extension system supports environment variables for configuration, which is particularly useful for:
- Security-sensitive information (API keys, secrets)
- Environment-specific settings
- Development vs. production configurations

### Setting Environment Variables

Environment variables are typically defined in the `.env` file at the project root:

```
# Extension-specific environment variables
GOOGLE_CLIENT_ID=your-client-id
GOOGLE_CLIENT_SECRET=your-client-secret
MAIL_HOST=smtp.example.com
MAIL_PORT=587
```

### Using Environment Variables in Extensions

Extensions can retrieve environment variables with the `getenv()` or `env()` helper function:

```php
// Inside your extension
$clientId = getenv('GOOGLE_CLIENT_ID') ?: '';
// Or using the env() helper with a default value
$smtpHost = env('MAIL_HOST', 'smtp.default.com');
```

### Extension-Specific Environment Variables Pattern

For robust extension configuration, implement a pattern that combines configuration files with environment variables:

```php
// Load configuration from extension settings or environment
$config = \Glueful\Extensions\YourExtension::getConfig();

// Make sure the config has the expected structure
if (!is_array($config) || !isset($config['service']) || !is_array($config['service'])) {
    $config = [
        'service' => []
    ];
}

// Get config value with fallback to environment variable
$apiKey = !empty($config['service']['api_key']) ? 
          $config['service']['api_key'] : 
          (getenv('SERVICE_API_KEY') ?: '');
```

### Common Environment Variables for Extensions

Depending on the extension type, you may need specific environment variables:

#### Authentication Extensions
```
# OAuth Providers
GOOGLE_CLIENT_ID=...
GOOGLE_CLIENT_SECRET=...
GOOGLE_REDIRECT_URI=https://yourdomain.com/auth/social/google/callback

FACEBOOK_APP_ID=...
FACEBOOK_APP_SECRET=...
```

#### Email Extensions
```
MAIL_HOST=smtp.example.com
MAIL_PORT=587
MAIL_USERNAME=your-username
MAIL_PASSWORD=your-password
MAIL_ENCRYPTION=tls
MAIL_FROM_ADDRESS=noreply@example.com
MAIL_FROM_NAME="Your Application"
```

## Runtime Configuration

Some extension settings may need to be adjusted during runtime, without restarting the application.

### Admin Interface Configuration

Extensions can expose configuration options through the admin interface, allowing authorized users to modify settings without editing files:

1. Register configuration options through the admin dashboard
2. Store settings in the database
3. Access runtime settings through your extension's API

### Configuration Caching

For better performance, extension configurations can be cached:

```php
// Cache extension configuration
php glueful cache set extension_config:YourExtension "{'setting1':'value1'}" 3600
```

To clear the cache when configuration changes:

```php
php glueful cache delete extension_config:YourExtension
```

### Conditional Configuration

Extensions can adapt their behavior based on the current environment and their tier status:

```php
// Inside your extension
$environment = env('APP_ENV', 'production');
$isCore = (self::getMetadata()['type'] ?? 'optional') === 'core';

if ($environment === 'development') {
    // Development-specific configuration
    $debugMode = true;
    $logLevel = 'debug';
    $enableExperimentalFeatures = true;
} else if ($environment === 'production') {
    // Production configuration
    $debugMode = false;
    $logLevel = $isCore ? 'warning' : 'error'; // Core extensions get more verbose logs
    $enableExperimentalFeatures = false;
    
    // Special handling for core extensions in production
    if ($isCore) {
        // Activate failsafe mechanisms for core extensions
        $enableFailover = true;
        $heartbeatInterval = 60; // seconds
        $criticalErrorNotification = true;
    }
} else {
    // Staging or other environments
    $debugMode = false;
    $logLevel = 'info';
    $enableExperimentalFeatures = true;
}
```

#### Tier-Aware Configuration Loading

Extensions can implement tier-aware configuration loading to ensure that appropriate defaults and constraints are applied:

```php
/**
 * Load tier-appropriate configuration
 * 
 * @return array Configuration values
 */
public static function loadConfig(): array
{
    $baseConfig = self::getConfig(); // Get the base configuration
    $isCore = (self::getMetadata()['type'] ?? 'optional') === 'core';
    $environment = env('APP_ENV', 'production');
    
    // If we're a core extension in production,
    // ensure critical settings have safe values
    if ($isCore && $environment === 'production') {
        $criticalDefaults = [
            'retry_attempts' => 3,
            'timeout' => 30,
            'critical_mode' => true,
            'auto_recovery' => true
        ];
        
        // Apply critical defaults but don't override explicit config values
        foreach ($criticalDefaults as $key => $value) {
            if (!isset($baseConfig[$key])) {
                $baseConfig[$key] = $value;
            }
        }
    }
    
    return $baseConfig;
}
```

## Best Practices

When configuring extensions in Glueful, follow these best practices:

1. **Security First**: Never hardcode sensitive information (API keys, passwords) in extension code
2. **Fallbacks**: Always provide fallback values when accessing configuration
3. **Validation**: Validate configuration values to prevent runtime errors
4. **Documentation**: Document all configuration options with examples
5. **Minimal Requirements**: Only require essential configuration; make everything else optional
6. **Consistent Naming**: Use consistent naming conventions for configuration keys and environment variables
7. **Extension Namespace**: Prefix environment variables with your extension name to avoid conflicts

## Extension Administration

Managing extensions efficiently requires understanding how to handle different types of extensions and their specific requirements.

## Extension Tiers

Glueful's extension system categorizes extensions into different tiers based on their importance to system functionality. Understanding these tiers is crucial for effective extension administration.

### Core vs Optional Extensions

The admin dashboard clearly distinguishes between two types of extensions:

- **Core Extensions**: Displayed with a "Core" badge and typically appear at the top of the extension list. These extensions provide essential functionality and have special protection against accidental disabling or removal.

- **Optional Extensions**: Standard extensions that add useful but non-essential functionality to your Glueful application.

![Extension Tiers](/images/admin/extensions-tiers.png)

### Managing Extensions by Tier

#### Core Extensions

Core extensions require additional confirmation when attempting to disable or delete them:

![Core Extension Warning](/images/admin/core-extension-warning.png)

When managing core extensions:

- **Disabling**: Requires explicit confirmation and may only be possible in non-production environments
- **Deletion**: Strongly discouraged and requires special authorization
- **Configuration**: May have limited configuration options to preserve system stability

#### Optional Extensions

Optional extensions can be freely enabled, disabled, or removed based on your needs:

- **Environment-Specific**: Can be configured differently across development, staging, and production
- **Customization**: Generally offer more configuration options
- **Dependency Awareness**: The system will alert you if disabling an optional extension would affect other enabled extensions

### Extension Dependency Management

The admin dashboard visualizes extension dependencies with special attention to tier relationships:

![Extension Dependencies](/images/admin/extensions-dependencies.png)

The dependency graph uses color coding to distinguish between:
- Core-to-core dependencies
- Core-to-optional dependencies
- Optional-to-core dependencies
- Optional-to-optional dependencies

This visualization helps administrators understand the potential system impact of enabling or disabling specific extensions.

## Environment-Specific Extension Management

Different environments may require different extension configurations. Glueful's tiered extension system provides robust support for environment-specific management:

```php
// In config/extensions.php
return [
    // Core extensions are critical to system functionality
    'core' => [
        'UserManagement',
        'SecurityModule',
        'ApiFramework',
        'DatabaseManager'
    ],
    
    // Optional extensions provide additional features
    'optional' => [
        'SocialLogin',
        'ReportGenerator',
        'NotificationSystem',
        'AdvancedAnalytics',
        'DevTools'
    ],
    
    // All currently enabled extensions
    'enabled' => [
        'UserManagement',
        'SecurityModule',
        'ApiFramework',
        'DatabaseManager',
        'SocialLogin',
        'NotificationSystem'
    ],
    
    // Environment-specific configurations
    'environments' => [
        'production' => [
            'enabled' => [
                // In production, all core extensions are automatically enabled
                // You can explicitly list additional optional extensions here
                'SocialLogin',
                'NotificationSystem'
            ],
            'settings' => [
                // Environment-specific extension settings
                'NotificationSystem' => [
                    'allow_sms' => true,
                    'throttle_enabled' => true
                ]
            ],
            'tier_rules' => [
                // Specify additional tier-specific rules for this environment
                'core' => [
                    'force_health_checks' => true,
                    'auto_restart_on_failure' => true
                ],
                'optional' => [
                    'disable_on_error' => true
                ]
            ]
        ],
        'staging' => {
            'enabled' => [
                // Core extensions are auto-included
                'SocialLogin',
                'NotificationSystem',
                'AdvancedAnalytics'
            ],
            'settings' => {
                'NotificationSystem' => [
                    'allow_sms' => false,
                    'use_test_gateway' => true
                ]
            }
        },
        'development' => [
            'enabled' => [
                // Core extensions are auto-included
                'SocialLogin',
                'NotificationSystem',
                'AdvancedAnalytics',
                'DevTools'  // Development-only extension
            ],
            'settings' => [
                'SecurityModule' => [
                    'strict_validation' => false,
                    'debug_mode' => true
                ],
                'NotificationSystem' => [
                    'use_mock_providers' => true
                ]
            },
            'tier_rules' => [
                'core' => [
                    'allow_override' => true, // Allow overriding core functionality in dev
                ],
                'optional' => {
                    'auto_reload_on_change' => true
                }
            ]
        ]
    ]
];
```

### Tier-Specific Environment Behaviors

The tiered extension system implements different behaviors based on the environment:

**Production Environment**:
- All core extensions are automatically enabled and cannot be disabled through the UI without special permissions
- Core extensions have strict health monitoring with automated recovery protocols
- Optional extensions can be freely enabled/disabled but with dependency validation
- Configuration changes to core extensions require additional confirmation

**Staging Environment**:
- Core extensions are automatically enabled but can be temporarily disabled for testing
- Testing configurations can be applied to both core and optional extensions
- Detailed logging is enabled for extension performance and behavior

**Development Environment**:
- All extensions including development tools can be freely enabled/disabled
- Core extensions can be modified and overridden for development purposes
- Debug logs are enabled for all extension operations
- Hot-reloading is available for extension code changes

### Managing Extensions Through the Admin Interface

The admin dashboard provides a user-friendly interface for managing extensions:

1. **Extensions Page**: Navigate to the Extensions section of the admin dashboard
2. **Enable/Disable**: Toggle extensions on or off with a single click
3. **Configuration**: Access extension-specific settings through the gear icon
4. **Dependencies**: View the dependency graph to understand relationships
5. **Health Monitoring**: Check extension health status and resource usage
6. **Logs**: Access extension-specific logs for troubleshooting

### Extension Health Monitoring

Monitor your extensions' health through the admin dashboard:

- **Health Status**: Green/yellow/red indicators show extension health
- **Resource Usage**: Charts display memory usage, execution time, and database queries
- **Error Logs**: View extension-specific error logs
- **Dependency Status**: Check if all dependencies are satisfied and healthy

### Extension Troubleshooting

If you encounter issues with extensions:

1. **Check Logs**: Review extension-specific logs for error messages
2. **Verify Dependencies**: Ensure all required dependencies are installed and enabled
3. **Test in Safe Mode**: Temporarily disable non-essential extensions to isolate issues
4. **Check Configuration**: Verify that configuration values are correct
5. **Update Extensions**: Ensure you're using the latest version of the extension

### Extension Updates

Keep your extensions up-to-date to benefit from the latest features and security patches:

```bash
# Update a specific extension
php glueful extensions update YourExtension

# Update all extensions
php glueful extensions update --all

# Check for available updates
php glueful extensions check-updates
```
