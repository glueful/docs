---
title: Schema
description: Working with database schema in Glueful
navigation:
  icon: i-lucide-database
---

# Database Schema

Glueful provides powerful schema management tools through the SchemaManager classes, which support multiple database engines including MySQL, PostgreSQL, and SQLite.

## SchemaManager Overview

The schema manager allows you to create, modify, and manage database structures using a consistent API regardless of the underlying database engine.

```php
use Glueful\Database\Connection;

// Get the appropriate schema manager for your database
$connection = new Connection();
$schema = $connection->getSchemaManager();
```

## Creating Tables

Create tables with columns, indexes, and foreign keys:

```php
$schema->createTable('users', [
    'id' => 'BIGINT PRIMARY KEY AUTO_INCREMENT',
    'uuid' => 'CHAR(12) NOT NULL',
    'username' => 'VARCHAR(255) NOT NULL',
    'email' => 'VARCHAR(255) NOT NULL',
    'password' => 'VARCHAR(100) NOT NULL',
    'status' => "VARCHAR(20) DEFAULT 'active'",
    'created_at' => 'TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP',
    'updated_at' => 'TIMESTAMP NULL ON UPDATE CURRENT_TIMESTAMP'
]);
```

## Adding Indexes

Add various types of indexes to optimize queries:

```php
// Add indexes to an existing or newly created table
$schema->createTable('products', [
    'id' => 'BIGINT PRIMARY KEY AUTO_INCREMENT',
    'name' => 'VARCHAR(255) NOT NULL',
    'price' => 'DECIMAL(10,2) NOT NULL',
    'category_id' => 'BIGINT NOT NULL'
])->addIndex([
    // Single column unique index
    ['type' => 'UNIQUE', 'column' => 'name', 'table' => 'products'],

    // Regular index
    ['type' => 'INDEX', 'column' => 'category_id', 'table' => 'products'],

    // Multi-column index
    ['type' => 'INDEX', 'column' => ['name', 'price'], 'table' => 'products']
]);
```

## Foreign Keys

Establish relationships between tables:

```php
$schema->createTable('orders', [
    'id' => 'BIGINT PRIMARY KEY AUTO_INCREMENT',
    'user_id' => 'BIGINT NOT NULL',
    'total' => 'DECIMAL(10,2) NOT NULL',
    'status' => 'VARCHAR(50) NOT NULL'
])->addForeignKey([
    [
        'column' => 'user_id',
        'references' => 'id',
        'on' => 'users',
        'onDelete' => 'CASCADE',
        'onUpdate' => 'CASCADE'
    ]
]);
```

## Modifying Tables

Modify existing tables by adding, renaming or modifying columns:

```php
// Add a new column to an existing table
$schema->addColumn('users', 'phone_number', 'VARCHAR(20) NULL');

// Modify column
$schema->modifyColumn('users', 'status', "ENUM('active', 'inactive', 'banned') DEFAULT 'active'");

// Rename column
$schema->renameColumn('users', 'phone_number', 'contact_number');
```

## Dropping Tables and Columns

Remove database objects when no longer needed:

```php
// Drop a table
$schema->dropTable('temp_users');

// Drop a column
$schema->dropColumn('users', 'unused_column');

// Drop an index
$schema->dropIndex('users', 'index_name');
```

## Database-Specific Features

Each SchemaManager implementation provides engine-specific features:

### MySQL Features

```php
// MySQL-specific table options
$schema->createTable('large_data', [
    'id' => 'BIGINT PRIMARY KEY AUTO_INCREMENT',
    'data' => 'LONGBLOB NOT NULL'
], [
    'engine' => 'InnoDB',
    'charset' => 'utf8mb4',
    'collation' => 'utf8mb4_unicode_ci',
    'comment' => 'Stores large binary data'
]);

// Full-text search index
$schema->addIndex([
    'type' => 'FULLTEXT',
    'column' => ['title', 'content'],
    'table' => 'articles'
]);
```

### PostgreSQL Features

```php
// PostgreSQL-specific table options
$schema->createTable('geo_data', [
    'id' => 'BIGSERIAL PRIMARY KEY',
    'point' => 'GEOMETRY(POINT, 4326) NOT NULL'
]);

// GIN index for fast full-text search
$schema->addIndex([
    'type' => 'GIN',
    'column' => 'search_vector',
    'table' => 'documents'
]);
```

### SQLite Features

```php
// SQLite WITHOUT ROWID optimization
$schema->createTable('lookup', [
    'id' => 'INTEGER PRIMARY KEY',
    'code' => 'TEXT NOT NULL',
    'value' => 'TEXT NOT NULL'
], [
    'without_rowid' => true
]);
```

## Retrieving Schema Information

Inspect database schema:

```php
// Get table structure
$tableInfo = $schema->getTableStructure('users');

// Get table size
$size = $schema->getTableSize('large_data');

// Get row count
$count = $schema->getTableRowCount('users');
```

## Performance Considerations

- Use appropriate index types for your query patterns
- Be careful with adding too many indexes as they slow down write operations
- Consider using foreign key constraints only for critical relationships
- For large tables, always use indexed columns in WHERE clauses
- Be mindful of schema changes on large tables as they can lock tables during alteration
