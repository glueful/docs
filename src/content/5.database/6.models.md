---
title: Models
description: Working with database models in Glueful
navigation:
  icon: i-lucide-database
---

# Database Models

This section covers working with database models in the Glueful framework.

## Repository Pattern

Glueful implements the repository pattern for database access:

```php
<?php

namespace App\Repository;

use Glueful\Database\Connection;
use Glueful\Database\QueryBuilder;

class UserRepository
{
    private QueryBuilder $db;

    public function __construct()
    {
        $connection = new Connection();
        $this->db = new QueryBuilder($connection->getPDO(), $connection->getDriver());
    }

    public function getAll(array $filters = [], int $limit = 20, int $offset = 0)
    {
        $query = $this->db->table('users')
            ->select(['uuid', 'username', 'email', 'status', 'created_at']);

        if (isset($filters['status'])) {
            $query->where('status', '=', $filters['status']);
        }

        return $query->limit($limit)
            ->offset($offset)
            ->orderBy('created_at', 'DESC')
            ->get();
    }

    public function findById(string $id)
    {
        return $this->db->table('users')
            ->select(['uuid', 'username', 'email', 'status', 'created_at'])
            ->where('uuid', '=', $id)
            ->first();
    }
}
```

## Query Builder

The query builder provides a fluent interface for SQL operations:

```php
// Basic selects
$users = $db->table('users')
    ->select(['id', 'name', 'email'])
    ->where('status', '=', 'active')
    ->orderBy('name', 'ASC')
    ->limit(10)
    ->get();

// Joins
$posts = $db->table('posts')
    ->select(['posts.id', 'posts.title', 'users.name as author'])
    ->join('users', 'users.id', '=', 'posts.user_id')
    ->where('posts.status', '=', 'published')
    ->get();

// Aggregates
$count = $db->table('users')
    ->where('status', '=', 'active')
    ->count();
```

## Transactions

```php
try {
    $db->beginTransaction();

    // Perform multiple operations
    $userId = $db->table('users')->insertGetId([
        'name' => 'John Doe',
        'email' => 'john@example.com',
    ]);

    $db->table('profiles')->insert([
        'user_id' => $userId,
        'bio' => 'New user bio',
    ]);

    $db->commit();
} catch (\Exception $e) {
    $db->rollBack();
    throw $e;
}
```
